\documentclass{article}
\usepackage[preprint]{neurips_2024}
\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{xcolor}         % colors
\usepackage{natbib}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{float}
\bibliographystyle{apalike}


\title{Cross-Region Information Flow During Visual Stimuli}
\author{%
    Adam Pitner\\
    Department of Psychology\\
    New York University\\
    \texttt{ap6231@nyu.edu}\\
    \And Judy Yang\\
    Center for Data Science\\
    New York University\\
    \texttt{hy1331@nyu.edu}}


\begin{document}
\maketitle
\begin{abstract}
    
\end{abstract}
\section{Introduction}
\subsection{Traditional View of Visual Processing Hierarchy}
The mammalian visual system has long been conceptualized as a hierarchical feedforward network. In the primate model, visual information flows sequentially from the retina through the lateral geniculate nucleus (LGN) of the thalamus to primary visual cortex (V1), then progressively through higher-order visual areas (V2, V4, MT) with increasing receptive field complexity and processing specialization \citep{felleman1991distributed, mishkin1983object}. This hierarchical organization, supported by anatomical tract-tracing and electrophysiological studies, suggests that each processing stage adds computational sophistication: V1 detects edges and orientations, V2 processes contours and textures, while higher areas encode complex features like object identity and motion \citep{hubel1962receptive, livingstone1988segregation}.

In rodents, particularly mice, the visual cortex exhibits a similar organizational principle with primary visual cortex (VISp, analogous to primate V1) receiving direct input from the dorsal lateral geniculate nucleus (LGd) and projecting to multiple higher visual areas (HVAs) including lateral (VISl), anterolateral (VISal), anteromedial (VISam), and posteromedial (VISpm) areas \citep{wang2007area, marshel2011functional}. Classical models predict sequential activation: LGd responds first (~30-40ms), followed by VISp (~40-60ms), then HVAs with progressively longer latencies (~60-100ms) as information ascends the hierarchy \citep{gao2010parallel}.

However, accumulating evidence challenges this strictly serial model. Anatomical studies reveal extensive parallel pathways and reciprocal connections between visual areas \citep{d2022hierarchical, siegle2021survey}. The lateral posterior nucleus (LP) of the thalamus, traditionally considered "higher-order," shows bidirectional connectivity with both VISp and multiple HVAs, potentially enabling parallel information streams that bypass the classical cortical hierarchy \citep{roth2016thalamic, bennett2019higher}. Furthermore, recent large-scale electrophysiology studies have documented near-simultaneous activation of multiple visual areas, suggesting that parallel processing may be more prevalent than previously appreciated \citep{siegle2021survey}.

\subsection{The Allen Brain Observatory Neuropixels Dataset}
The advent of high-density silicon probes has revolutionized our ability to record from large populations of neurons simultaneously across multiple brain regions. The Allen Brain Observatory Visual Coding - Neuropixels dataset \citep{AllenInstituteNeuropixels2019} represents a landmark resource, providing standardized recordings from over 40,000 neurons across 14+ brain regions in awake, head-fixed mice viewing diverse visual stimuli \citep{siegle2021survey, de2020large}. Each experimental session captures activity from primary and higher-order visual cortical areas, subcortical structures including thalamus, and even hippocampal regions, all recorded simultaneously with the same temporal reference.

This dataset offers unprecedented opportunities to examine visual information flow across brain networks. Unlike traditional studies that record from single regions in isolation, the multi-region recording capability enables direct comparison of response timing, trial-by-trial correlations, and directional information transfer between areas \citep{jun2017fully}. The standardized stimulus presentations—including drifting gratings, static gratings, natural images, and natural movies—allow systematic characterization of how different visual features propagate through cortical and subcortical networks.

\subsection{Present Study Objectives}
Despite the availability of this rich dataset, fundamental questions about visual information flow in the mouse brain remain incompletely resolved. Specifically: (1) Do visual areas activate in strict hierarchical sequence, or is there evidence for parallel input pathways? (2) How do cortical areas interact with thalamic nuclei—does the LP nucleus receive feedforward input or cortical feedback? (3) Which analytical approaches (cross-correlation, Granger causality, spike-triggered averages) most effectively reveal directional information flow between brain regions?

Here we leverage the Allen Neuropixels dataset to systematically characterize cross-region information flow during visual stimulation. We employ complementary analytical methods to measure response latencies (identifying temporal sequence), pairwise correlations (revealing functional coupling), and directed causal relationships (testing information transfer). Our goal is to construct a data-driven model of how visual information cascades through mouse cortical and subcortical networks, providing insights into the organizational principles governing sensory processing in the mammalian brain.

\section{Methods}
\subsection{Data Acquisition}
Data were obtained from the Allen Brain Observatory Neuropixels Visual Coding dataset \citep{AllenInstituteNeuropixels2019}, which provides simultaneous large-scale neural recordings across multiple brain regions in awake, head-fixed mice during passive viewing of visual stimuli. We analyzed session 721123822 (brain\_observatory\_1.1 session type), which contained 444 well-isolated single units recorded over 163.5 minutes using Neuropixels silicon probes \citep{jun2017fully}.

Units were distributed across seven brain regions: lateral posterior thalamus (LP, \textit{n}=69 units), primary visual cortex (VISp, \textit{n}=41), lateral visual area (VISl, \textit{n}=27), anterolateral visual area (VISal, \textit{n}=37), anteromedial visual area (VISam, \textit{n}=39), and hippocampal regions CA1 (\textit{n}=71) and CA3 (\textit{n}=10). Units exhibited mean firing rates of 8.09 $\pm$ 6.92 Hz (mean $\pm$ SD) with a signal-to-noise ratio of 2.89 $\pm$ 1.24 (mean $\pm$ SD), indicating good unit isolation quality.

Visual stimuli included drifting gratings, static gratings, natural images, natural movie clips, Gabor patches, and full-field flashes presented on a calibrated monitor positioned 15 cm from the mouse's eye. Spike times were extracted using Kilosort2 spike sorting \citep{Pachitariu2016} and manually curated by Allen Institute personnel. All spike times were referenced to stimulus onset times with millisecond precision.

\subsection{Stimulus Selection and Preprocessing}
For temporal dynamics analysis, we focused on responses to drifting sinusoidal gratings, which elicit robust, reliable responses in mouse visual cortex \citep{Niell2008}. The session contained 628 presentations of drifting gratings with varying orientations (9 directions), temporal frequencies (6 values), and contrasts (2 levels), each presented for 2 seconds. We selected drifting gratings over other stimulus types (natural movies, static images) because pilot analyses revealed they produced the strongest stimulus-locked responses across visual cortical areas, facilitating reliable latency estimation.

For each brain region, we included only regions with $\geq$10 well-isolated units to ensure stable population-level estimates. This criterion resulted in seven regions for analysis, yielding 21 unique region pairs for connectivity analyses.

\subsection{Response Latency Analysis}

\subsubsection{Population PSTH Computation}
To measure response timing for each brain region, we computed population peri-stimulus time histograms (PSTHs) by pooling spike times across all units within a region. For each stimulus presentation, we binned spikes in 10 ms bins from -200 ms (pre-stimulus baseline) to +500 ms (post-stimulus response) relative to grating onset. We randomly subsampled 1000 of the 628 available trials to balance computational efficiency with statistical power. The population firing rate was calculated by averaging spike counts across trials and dividing by bin width and number of units, yielding rates in Hz.

\subsubsection{Latency Detection}
Response latency was defined as the first time point after stimulus onset where the population firing rate exceeded a detection threshold. To properly account for biological variability rather than temporal smoothness of the averaged PSTH, we computed the threshold using trial-to-trial variance. For each trial, we summed total spike counts during the baseline period (-200 to 0 ms), converted these to firing rates (spikes/duration/n\_units), and computed the standard deviation across trials. The detection threshold was set to \texttt{baseline\_mean} + 1.5 × \texttt{baseline\_std\_trials}, where baseline variability was computed from trial-by-trial fluctuations rather than temporal fluctuations within the averaged PSTH.

This approach captures genuine biological variability in neural responses across stimulus presentations, avoiding the artificially small variance that results from temporal smoothing of trial-averaged data. We applied Gaussian smoothing ($\sigma$ = 2 bins) to the population PSTH for visualization only; latency detection used unsmoothed data.

Regions where the maximum post-stimulus response never exceeded threshold were classified as non-responsive. For responsive regions, we verified that detected latencies fell within the biologically plausible range of 30-150 ms for mouse visual cortex \citep{gao2010parallel}.

\subsection{Cross-Correlation Analysis}
To quantify temporal relationships between brain regions, we computed cross-correlations between population firing rate time series. For each region, we binned spike times at 10 ms resolution across the entire recording session, computing average firing rates by pooling spikes across all units within the region. Cross-correlations were computed with a maximum lag of $\pm$200 ms, providing sufficient temporal coverage to detect both fast monosynaptic connections (5-10 ms) and polysynaptic pathways or feedback loops (50-100 ms).

For each region pair, we identified the lag at which correlation was maximized and the corresponding correlation coefficient. Zero-lag correlations indicate synchronous activation, while positive or negative lags suggest directional temporal relationships. However, cross-correlation alone cannot distinguish genuine functional connectivity from correlations induced by common stimulus drive, motivating our subsequent noise correlation analysis.

\subsection{Noise Correlation Analysis}
To distinguish stimulus-driven from connectivity-driven correlations, we decomposed population responses into signal and noise components \citep{cohen2011measuring}. For each region, we computed trial-by-trial firing rate matrices (trials $\times$ time bins) during the peri-stimulus window (-200 to +500 ms). 

The \textbf{signal} component was defined as the mean response across trials:
\begin{equation}
\text{signal}_r(t) = \frac{1}{N}\sum_{i=1}^{N} \text{rate}_{r,i}(t)
\end{equation}
where $r$ indexes region, $i$ indexes trial, and $t$ indexes time bin.

The \textbf{noise} component was defined as trial-by-trial deviations from the mean:
\begin{equation}
\text{noise}_{r,i}(t) = \text{rate}_{r,i}(t) - \text{signal}_r(t)
\end{equation}

For each region pair, we computed:
\begin{itemize}
\item \textbf{Signal correlation}: Pearson correlation between mean responses, $\text{corr}(\text{signal}_{r_1}, \text{signal}_{r_2})$
\item \textbf{Noise correlation}: Pearson correlation between trial fluctuations, $\text{corr}(\text{noise}_{r_1}, \text{noise}_{r_2})$ (flattening across trials and time bins)
\end{itemize}

Signal correlations reflect stimulus-locked co-activation, while noise correlations reflect trial-to-trial co-fluctuations independent of the mean response, providing evidence for functional connectivity beyond common drive \citep{cohen2011measuring}.

\subsection{Statistical Analysis and Confidence Intervals}
To assess the statistical reliability of noise correlations, we computed 95\% confidence intervals using bootstrap resampling. For each region pair, we resampled trials with replacement (1000 iterations), recomputed signal and noise components for each bootstrap sample, and calculated noise correlations. Confidence intervals were defined as the 2.5th and 97.5th percentiles of the bootstrap distribution. Region pairs were considered to have significant functional connectivity if the noise correlation confidence interval excluded zero.

All analyses were performed in Python 3.10 using NumPy \citep{Harris2020}, SciPy \citep{virtanen2020scipy}, and Pandas \citep{mckinney2010data}. Population PSTHs and cross-correlations were computed using vectorized operations for computational efficiency. Data visualization was performed using Matplotlib \citep{hunter2007matplotlib} and Seaborn \citep{waskom2021seaborn}.

\section{Results}

\subsection{Phase 1: Temporal Dynamics of Visual Response}

\subsubsection{Response Latencies Reveal Parallel Activation}
Population-level PSTH analysis revealed robust visual responses across five of seven recorded brain regions (Figure \ref{fig:psths}). Primary visual cortex (VISp), lateral visual area (VISl), and anterolateral visual area (VISal) all showed response latencies of 45 ms after stimulus onset. Lateral posterior thalamus (LP) and anteromedial visual area (VISam) exhibited slightly delayed responses at 55 ms, representing a 10 ms lag relative to the cortical areas. Hippocampal regions CA1 and CA3 showed no clear stimulus-locked responses, consistent with the absence of visual feature encoding during passive viewing of simple gratings.

\begin{figure}[H]
\centering
\includegraphics[width=0.5\textwidth]{results/phase1_regional_psths.png}
\caption{\textbf{Population peri-stimulus time histograms reveal parallel activation across visual areas.} Each panel shows population firing rate (smoothed, black line; raw, gray line) aligned to stimulus onset (green vertical line) for one brain region. Horizontal dashed lines indicate baseline (blue) and response threshold (red). Orange vertical lines mark detected response latencies. VISp, VISl, and VISal all responded at 45 ms, while LP and VISam responded at 55 ms. CA1 and CA3 showed no clear visual responses. Note VISl exhibited the strongest response magnitude (peak ~22 Hz).}
\label{fig:psths}
\end{figure}

The simultaneous activation of multiple visual cortical areas (VISp, VISl, VISal at 45 ms) challenges traditional hierarchical models predicting sequential relay (V1 $\rightarrow$ V2 $\rightarrow$ higher areas). Instead, our findings support parallel processing architectures where multiple cortical regions receive near-simultaneous input, likely via independent thalamic pathways.

Response magnitudes varied across regions (Figure \ref{fig:psths}). VISl showed the strongest response, with firing rates increasing from 6.5 Hz baseline to 22.2 Hz during stimulus presentation (15.7 Hz increase). VISp exhibited a moderate response (6.5 Hz to 19.6 Hz, 13.1 Hz increase), while VISal showed the smallest visual response (4.9 Hz to 14.2 Hz, 9.3 Hz increase). LP showed comparable response magnitude to VISp (7.4 Hz to 25.3 Hz, 17.9 Hz increase), despite its 10 ms longer latency.

\begin{figure}[h]
\centering
\includegraphics[width=0.6\textwidth]{results/phase1_latency_comparison.png}
\caption{\textbf{Response latency comparison across brain regions.} Bar chart showing response latencies ordered from earliest to latest. VISp, VISl, and VISal showed simultaneous responses at 45 ms (gray bars), while LP and VISam responded 10 ms later at 55 ms (colored by hierarchy position). Simultaneous activation of multiple cortical areas suggests parallel rather than serial information processing.}
\label{fig:latencies}
\end{figure}

The temporal ordering of responses—with LP responding 10 ms after cortical areas—suggests LP receives cortical feedback rather than serving as the primary driver of cortical activation. This finding is consistent with recent characterizations of LP as a higher-order thalamic nucleus involved in cortico-thalamic loops rather than sensory relay \citep{bennett2019higher}.

\subsection{Phase 2: Functional Connectivity Analysis}

\subsubsection{Cross-Correlation Reveals Synchronous Activation Patterns}

\begin{figure}[h]
\centering
\includegraphics[width=0.5\textwidth]{results/phase2_cross_correlations.png}
\caption{\textbf{Cross-correlation analysis reveals zero-lag synchrony across visual areas.} Each panel shows normalized cross-correlation between one region pair as a function of temporal lag. Vertical lines indicate zero lag (gray dashed) and peak correlation lag (red dashed). Visual cortical pairs (e.g., VISp-VISl, VISp-VISam) exhibited strong zero-lag correlations (\textit{r} = 0.25-0.45), while visual-hippocampal pairs showed minimal correlation (\textit{r} < 0.10). The predominance of zero-lag peaks indicates synchronous activation consistent with Phase 1 latency findings.}
\label{fig:cross_corr}
\end{figure}

Cross-correlation analysis (Figure \ref{fig:cross_corr}) revealed predominantly zero-lag correlations between visual cortical areas, consistent with the simultaneous response latencies observed in Phase 1. The strongest correlations were observed between visual cortical pairs: VISp-VISam (\textit{r} = 0.43, lag = 0 ms), VISp-VISl (\textit{r} = 0.34, lag = 0 ms), and VISl-VISam (\textit{r} = 0.28, lag = 0 ms). LP showed moderate zero-lag correlations with all visual cortical areas (\textit{r} = 0.19-0.25), indicating synchronized activation across thalamo-cortical networks.

In stark contrast, visual cortex-hippocampus pairs exhibited minimal correlations (\textit{r} < 0.10), with most falling below statistical significance. This pattern held across all visual-hippocampal pairs tested, confirming the functional decoupling observed in Phase 1 latency analysis.

While these cross-correlation patterns demonstrate coordinated activation across visual areas, they cannot distinguish genuine functional connectivity from spurious correlations induced by common stimulus drive. Both interpretations would produce zero-lag correlations: regions could be synchronously activated either because they communicate directly with each other, or simply because they both respond to the same visual stimulus. This ambiguity motivated our noise correlation analysis.

\subsubsection{Noise Correlations Distinguish Connectivity from Common Drive}

\begin{figure}[h]
\centering
\includegraphics[width=\textwidth]{results/phase2_signal_vs_noise_comparison.png}
\caption{\textbf{Noise correlation analysis distinguishes functional connectivity from stimulus drive.} \textbf{Left:} Bar chart comparing signal correlation (blue, correlation of mean responses) and noise correlation (orange, correlation of trial-by-trial fluctuations with 95\% bootstrap confidence intervals) for each region pair. Visual cortical pairs showed substantial noise correlations (\textit{r} = 0.3-0.6), while visual-hippocampal pairs showed minimal noise correlations (\textit{r} < 0.1). \textbf{Right:} Scatter plot of signal versus noise correlations. Visual pairs (purple dots, upper right) clustered above the visual-hippocampal pairs (near origin), demonstrating that visual area correlations reflect genuine functional connectivity beyond common stimulus drive. Diagonal dashed line represents equal signal and noise contribution.}
\label{fig:noise_corr}
\end{figure}

To separate stimulus-driven from connectivity-driven correlations, we decomposed population responses into signal (mean stimulus-evoked response) and noise (trial-to-trial fluctuations) components (Figure \ref{fig:noise_corr}). This analysis revealed substantial noise correlations between visual cortical pairs, indicating genuine functional connectivity beyond common stimulus drive.

VISp-VISam exhibited the strongest functional coupling (noise correlation \textit{r} = 0.57, 95\% \textit{CI} [0.52, 0.62]), with 65\% of the total correlation attributable to connectivity rather than stimulus drive. VISp-VISl showed similarly robust connectivity (\textit{r} = 0.47, 95\% \textit{CI} [0.42, 0.52], 58\% connectivity contribution). Other visual cortical pairs demonstrated moderate noise correlations ranging from 0.28 to 0.39, all significantly above zero (bootstrap \textit{p} < 0.001).

LP-visual cortex pairs showed intermediate noise correlations (\textit{r} = 0.24-0.33), suggesting bidirectional thalamo-cortical coupling. The LP-VISam connection showed the strongest thalamo-cortical noise correlation (\textit{r} = 0.33, 95\% \textit{CI} [0.28, 0.38]), consistent with known anatomical projections between LP and VISam \citep{bennett2019higher}.

Critically, visual cortex-hippocampus pairs exhibited near-zero noise correlations (\textit{r} < 0.10, with confidence intervals overlapping zero), confirming the absence of functional connectivity during passive grating viewing. For example, VISp-CA1 showed \textit{r} = 0.06 (95\% \textit{CI} [-0.02, 0.14]) and VISp-CA3 showed \textit{r} = 0.04 (95\% \textit{CI} [-0.03, 0.11]), neither significantly different from zero. This pattern validates our noise correlation approach: if these values reflected purely methodological artifact, we would expect all region pairs to show similar correlations.

The hippocampal CA1-CA3 pair showed moderate internal noise correlation (\textit{r} = 0.28, 95\% \textit{CI} [0.23, 0.33]), indicating functional coupling within hippocampus despite the absence of visual responses. This suggests ongoing hippocampal activity unrelated to the passive visual task.

\subsubsection{Signal versus Noise Correlation Patterns}
Comparing signal and noise correlations revealed distinct patterns across region types (Figure \ref{fig:noise_corr}, right panel). Visual cortical pairs clustered in the upper-right quadrant with high signal correlations (\textit{r} = 0.7-0.9) and substantial noise correlations (\textit{r} = 0.3-0.6), indicating both stimulus-driven co-activation and intrinsic functional connectivity. The ratio of noise to signal correlation varied systematically: VISp-VISam (65\% noise), VISp-VISl (58\% noise), and LP-VISam (35\% noise), suggesting different degrees of connectivity strength relative to stimulus drive.

In contrast, visual-hippocampus pairs fell near the origin with low signal correlations (\textit{r} < 0.2) and minimal noise correlations (\textit{r} < 0.1), reflecting both weak stimulus responses and absent functional coupling. This stark dichotomy between visual-visual and visual-hippocampal patterns validates our analytical approach and demonstrates that noise correlations successfully isolate connectivity-driven relationships from stimulus artifacts.

All signal and noise correlations reported were computed from 1000 trials with bootstrap confidence intervals based on 1000 resampling iterations. The consistent separation between visual cortical pairs (significant noise correlations) and visual-hippocampal pairs (non-significant noise correlations) demonstrates the biological validity of our findings.

\section{Discussion}

\subsection{Parallel Processing Dominates Mouse Visual Cortex}
Our analysis of multi-region Neuropixels recordings revealed that visual information arrives simultaneously across multiple cortical areas rather than propagating through a strict hierarchical cascade. VISp (primary visual cortex), VISl (lateral visual area), and VISal (anterolateral visual area) all exhibited response latencies of 45 ms following stimulus onset, challenging the classical feedforward model where V1 activation would precede higher visual areas by 10-30 ms \citep{felleman1991distributed}.

This finding aligns with recent large-scale characterizations of mouse visual cortex \citep{siegle2021survey}, which documented near-simultaneous activation across visual areas and revealed extensive parallel thalamocortical pathways. Anatomical studies demonstrate that dorsal lateral geniculate nucleus (LGd) projects not only to VISp but also directly to multiple higher visual areas including VISl, VISal, and VISam \citep{d2022hierarchical}. Our results provide functional validation of these anatomical pathways: the simultaneous 45 ms responses likely reflect parallel thalamic input rather than serial cortico-cortical relay.

The small mouse brain facilitates rapid information transfer, with monosynaptic delays of only 1-3 ms given typical axonal conduction velocities and inter-regional distances. Even polysynaptic pathways (e.g., LGd $\rightarrow$ VISp $\rightarrow$ VISl) would introduce delays of only 5-10 ms. The fact that we observed no systematic delays between visual areas (within our 10 ms temporal resolution) suggests that parallel thalamic input predominates over sequential cortical processing for the initial visual response.

\subsection{LP Thalamus Receives Cortical Feedback Rather Than Driving Cortical Responses}
The lateral posterior (LP) nucleus of the thalamus exhibited a response latency of 55 ms, 10 ms later than VISp, VISl, and VISal. This temporal relationship suggests LP receives cortical feedback rather than serving as the primary driver of cortical visual responses. If LP provided feedforward input to cortex, we would expect LP to respond before or simultaneously with cortical areas, similar to the LGd-VISp relationship in traditional sensory relay pathways.

This interpretation is consistent with LP's characterization as a higher-order thalamic nucleus with extensive bidirectional connectivity to visual cortex \citep{bennett2019higher, roth2016thalamic}. LP receives direct input from layer 5 of visual cortex and projects back primarily to layer 1, forming cortico-thalamo-cortical loops that may serve modulatory rather than driving functions. Our noise correlation analysis revealed moderate LP-cortex coupling (\textit{r} = 0.24-0.33), indicating genuine functional connectivity. However, the delayed LP response suggests this connectivity operates primarily in the feedback direction during initial stimulus processing.

An alternative interpretation is that LP processes different visual features requiring longer integration time, or that LP responses reflect a second wave of thalamic input distinct from the initial LGd-driven response. Distinguishing between these possibilities would require causal perturbation experiments (e.g., optogenetic inactivation) beyond the scope of correlational analysis.

\subsection{Noise Correlations Reveal Connectivity Beyond Stimulus Drive}
A central challenge in analyzing stimulus-evoked neural data is distinguishing genuine functional connectivity from spurious correlations induced by common drive. When two brain regions both respond to the same stimulus, they will necessarily correlate even in the absence of direct communication—a confound that plagued our initial cross-correlation analysis and rendered Granger causality uninformative.

Noise correlation analysis addressed this limitation by decomposing correlations into stimulus-locked (signal) and trial-to-trial fluctuation (noise) components \citep{cohen2011measuring}. Visual cortical pairs exhibited substantial noise correlations (\textit{r} = 0.3-0.6), indicating that their trial-by-trial activity co-fluctuates beyond what the shared stimulus predicts. These correlated fluctuations likely reflect: (1) direct anatomical connections enabling information exchange, (2) shared neuromodulatory state affecting both regions, or (3) coordinated network dynamics involving polysynaptic pathways.

The strength of noise correlations varied systematically across visual areas. VISp-VISam showed the strongest coupling (\textit{r} = 0.57), suggesting robust bidirectional connectivity consistent with known anatomical projections between these areas \citep{wang2007area}. VISp-VISl exhibited slightly weaker but still substantial noise correlation (\textit{r} = 0.47), while LP-cortex pairs showed intermediate values (\textit{r} = 0.24-0.33). These graded connectivity strengths likely reflect differences in anatomical connection density and synaptic efficacy.

Critically, visual cortex-hippocampus pairs showed near-zero noise correlations (\textit{r} < 0.10, confidence intervals overlapping zero), validating our analytical approach. Hippocampal regions exhibited neither stimulus-locked responses (Phase 1) nor trial-to-trial coupling with visual areas (Phase 2), demonstrating functional decoupling during passive viewing. This pattern would not emerge if noise correlations simply reflected methodological artifact—instead, they successfully isolated genuine connectivity from common drive artifacts.

\subsection{Hippocampus is Decoupled During Passive Visual Processing}
Both hippocampal subfields (CA1 and CA3) showed absent visual responses, minimal cross-correlations with visual areas, and near-zero noise correlations. This finding is consistent with the hippocampus's role in spatial navigation, episodic memory, and contextual processing \citep{moser2008place}—functions not engaged by passive viewing of drifting gratings.

Hippocampal neurons can encode visual information, but typically only when visual cues predict spatial locations, reward outcomes, or other behaviorally relevant events. In freely moving rodents, hippocampal place cells integrate visual landmarks with self-motion cues to construct spatial representations. However, in head-fixed mice passively viewing non-spatial stimuli, hippocampal engagement is minimal.

The moderate CA1-CA3 noise correlation (\textit{r} = 0.28) indicates these regions maintain functional coupling with each other despite their decoupling from visual cortex. This intrinsic hippocampal activity likely reflects ongoing memory consolidation, default-mode processing, or spontaneous reactivation patterns independent of the visual task.

\subsection{Methodological Considerations and Limitations}

\subsubsection{Temporal Resolution and Binning}
Our analyses used 10 ms temporal bins for PSTH computation and 10-20 ms bins for correlation analyses. While this resolution successfully detected the 10 ms delay between early-responding (VISp, VISl, VISal at 45 ms) and late-responding (LP, VISam at 55 ms) regions, it may have obscured finer temporal structure. Monosynaptic delays of 1-3 ms or precise spike-timing relationships at millisecond resolution would not be detectable. However, for population-level questions about regional activation sequences—whether visual processing follows strict hierarchical ordering or parallel activation—our temporal resolution was appropriate and yielded clear answers.

\subsubsection{Population-Level Analysis}
We pooled spikes across all units within each region to construct population responses, sacrificing single-neuron resolution for statistical power and interpretability. This approach effectively characterizes regional dynamics but may obscure heterogeneity in neuronal response properties, cell-type-specific connectivity patterns, or sparse coding schemes where only subsets of neurons encode specific features. Future work examining single-neuron connectivity using spike-triggered averaging or coupling analysis could reveal finer-grained organizational principles.

\subsubsection{Correlation Does Not Prove Causation}
While noise correlations provide stronger evidence for functional connectivity than cross-correlation alone, they remain fundamentally correlational. Correlated trial-to-trial fluctuations could arise from direct anatomical connections, shared neuromodulatory input, or polysynaptic pathways. Distinguishing these possibilities requires causal perturbation experiments such as optogenetic stimulation/inhibition or focal pharmacological manipulations. Nevertheless, our multi-method approach—combining response latencies, cross-correlations, and noise correlations—provides convergent evidence for specific connectivity patterns.

\subsubsection{Failure of Granger Causality}
Our initial attempts to apply Granger causality analysis yielded implausibly dense connectivity networks with significant bidirectional relationships between all region pairs, including anatomically implausible connections (e.g., hippocampus predicting visual cortex with F-statistics exceeding 300). This failure illustrates an important limitation of Granger causality when applied to stimulus-evoked data: the method assumes stationarity and lacks mechanisms to account for common exogenous inputs. When all regions are driven by the same stimulus, past activity in any region appears to "predict" future activity in all other regions, producing spurious causality.

This methodological lesson has broader implications. Many time-series causality methods (Granger causality, transfer entropy, convergent cross-mapping) perform poorly on stimulus-evoked neural data without appropriate controls for common drive. Researchers should exercise caution when applying these methods to sensory recordings and consider stimulus-aware alternatives such as conditional Granger causality, partial correlation controlling for stimulus timing, or noise correlation decomposition as demonstrated here.

\subsection{Implications for Visual Processing Models}
Our findings support a revised model of mouse visual cortex organization where parallel processing predominates over strict hierarchical relay. Rather than information flowing sequentially V1 $\rightarrow$ V2 $\rightarrow$ V3, multiple cortical areas receive near-simultaneous thalamic input and engage in rapid bidirectional communication. This architecture may support faster processing of ethologically relevant stimuli (e.g., looming objects, moving predators) where speed is critical for survival.

The functional role of higher-order thalamus (LP) appears modulatory rather than driving, consistent with its position in cortico-thalamo-cortical loops. LP may serve to coordinate cortical dynamics, amplify salient features, or integrate information across visual areas, but does not appear to provide the initial sensory drive for cortical responses to simple visual features.

These organizational principles likely differ across species, stimuli, and behavioral contexts. Primate visual cortex exhibits stronger hierarchical structure with more pronounced serial processing, particularly for object recognition pathways. Even within mouse, different visual features (motion, orientation, spatial frequency) may engage distinct pathways. Future studies examining responses to naturalistic stimuli, during active behavior, or across different cortical layers could reveal context-dependent shifts between parallel and hierarchical processing modes.

\section{Discussion}

\subsection{Parallel Processing Dominates Mouse Visual Cortex}
Our analysis of multi-region Neuropixels recordings revealed that visual information arrives simultaneously across multiple cortical areas rather than propagating through a strict hierarchical cascade. VISp (primary visual cortex), VISl (lateral visual area), and VISal (anterolateral visual area) all exhibited response latencies of 45 ms following stimulus onset, challenging the classical feedforward model where V1 activation would precede higher visual areas by 10-30 ms \citep{felleman1991distributed}.

This finding aligns with recent large-scale characterizations of mouse visual cortex \citep{siegle2021survey}, which documented near-simultaneous activation across visual areas and revealed extensive parallel thalamocortical pathways. Anatomical studies demonstrate that dorsal lateral geniculate nucleus (LGd) projects not only to VISp but also directly to multiple higher visual areas including VISl, VISal, and VISam \citep{d2022hierarchical}. Our results provide functional validation of these anatomical pathways: the simultaneous 45 ms responses likely reflect parallel thalamic input rather than serial cortico-cortical relay.

The small mouse brain facilitates rapid information transfer, with monosynaptic delays of only 1-3 ms given typical axonal conduction velocities and inter-regional distances. Even polysynaptic pathways (e.g., LGd $\rightarrow$ VISp $\rightarrow$ VISl) would introduce delays of only 5-10 ms. The fact that we observed no systematic delays between visual areas (within our 10 ms temporal resolution) suggests that parallel thalamic input predominates over sequential cortical processing for the initial visual response.

\subsection{LP Thalamus Receives Cortical Feedback Rather Than Driving Cortical Responses}
The lateral posterior (LP) nucleus of the thalamus exhibited a response latency of 55 ms, 10 ms later than VISp, VISl, and VISal. This temporal relationship suggests LP receives cortical feedback rather than serving as the primary driver of cortical visual responses. If LP provided feedforward input to cortex, we would expect LP to respond before or simultaneously with cortical areas, similar to the LGd-VISp relationship in traditional sensory relay pathways.

This interpretation is consistent with LP's characterization as a higher-order thalamic nucleus with extensive bidirectional connectivity to visual cortex \citep{bennett2019higher, roth2016thalamic}. LP receives direct input from layer 5 of visual cortex and projects back primarily to layer 1, forming cortico-thalamo-cortical loops that may serve modulatory rather than driving functions. Our noise correlation analysis revealed moderate LP-cortex coupling (\textit{r} = 0.24-0.33), indicating genuine functional connectivity. However, the delayed LP response suggests this connectivity operates primarily in the feedback direction during initial stimulus processing.

An alternative interpretation is that LP processes different visual features requiring longer integration time, or that LP responses reflect a second wave of thalamic input distinct from the initial LGd-driven response. Distinguishing between these possibilities would require causal perturbation experiments (e.g., optogenetic inactivation) beyond the scope of correlational analysis.

\subsection{Noise Correlations Reveal Connectivity Beyond Stimulus Drive}
A central challenge in analyzing stimulus-evoked neural data is distinguishing genuine functional connectivity from spurious correlations induced by common drive. When two brain regions both respond to the same stimulus, they will necessarily correlate even in the absence of direct communication—a confound that plagued our initial cross-correlation analysis and rendered Granger causality uninformative.

Noise correlation analysis addressed this limitation by decomposing correlations into stimulus-locked (signal) and trial-to-trial fluctuation (noise) components \citep{cohen2011measuring}. Visual cortical pairs exhibited substantial noise correlations (\textit{r} = 0.3-0.6), indicating that their trial-by-trial activity co-fluctuates beyond what the shared stimulus predicts. These correlated fluctuations likely reflect: (1) direct anatomical connections enabling information exchange, (2) shared neuromodulatory state affecting both regions, or (3) coordinated network dynamics involving polysynaptic pathways.

The strength of noise correlations varied systematically across visual areas. VISp-VISam showed the strongest coupling (\textit{r} = 0.57), suggesting robust bidirectional connectivity consistent with known anatomical projections between these areas \citep{wang2007area}. VISp-VISl exhibited slightly weaker but still substantial noise correlation (\textit{r} = 0.47), while LP-cortex pairs showed intermediate values (\textit{r} = 0.24-0.33). These graded connectivity strengths likely reflect differences in anatomical connection density and synaptic efficacy.

Critically, visual cortex-hippocampus pairs showed near-zero noise correlations (\textit{r} < 0.10, confidence intervals overlapping zero), validating our analytical approach. Hippocampal regions exhibited neither stimulus-locked responses (Phase 1) nor trial-to-trial coupling with visual areas (Phase 2), demonstrating functional decoupling during passive viewing. This pattern would not emerge if noise correlations simply reflected methodological artifact—instead, they successfully isolated genuine connectivity from common drive artifacts.

\subsection{Hippocampus is Decoupled During Passive Visual Processing}
Both hippocampal subfields (CA1 and CA3) showed absent visual responses, minimal cross-correlations with visual areas, and near-zero noise correlations. This finding is consistent with the hippocampus's role in spatial navigation, episodic memory, and contextual processing \citep{moser2008place}—functions not engaged by passive viewing of drifting gratings.

Hippocampal neurons can encode visual information, but typically only when visual cues predict spatial locations, reward outcomes, or other behaviorally relevant events. In freely moving rodents, hippocampal place cells integrate visual landmarks with self-motion cues to construct spatial representations. However, in head-fixed mice passively viewing non-spatial stimuli, hippocampal engagement is minimal.

The moderate CA1-CA3 noise correlation (\textit{r} = 0.28) indicates these regions maintain functional coupling with each other despite their decoupling from visual cortex. This intrinsic hippocampal activity likely reflects ongoing memory consolidation, default-mode processing, or spontaneous reactivation patterns independent of the visual task.

\subsection{Methodological Considerations and Limitations}

\subsubsection{Temporal Resolution and Binning}
Our analyses used 5 ms temporal bins for PSTH computation and 10 ms bins for correlation analyses. While this resolution successfully detected the 10 ms delay between early-responding (VISp, VISl, VISal at 45 ms) and late-responding (LP, VISam at 55 ms) regions, it may have obscured finer temporal structure. Monosynaptic delays of 1-3 ms or precise spike-timing relationships at millisecond resolution would not be detectable. However, for population-level questions about regional activation sequences—whether visual processing follows strict hierarchical ordering or parallel activation—our temporal resolution was appropriate and yielded clear answers.

\subsubsection{Population-Level Analysis}
We pooled spikes across all units within each region to construct population responses, sacrificing single-neuron resolution for statistical power and interpretability. This approach effectively characterizes regional dynamics but may obscure heterogeneity in neuronal response properties, cell-type-specific connectivity patterns, or sparse coding schemes where only subsets of neurons encode specific features. Future work examining single-neuron connectivity using spike-triggered averaging or coupling analysis could reveal finer-grained organizational principles.

\subsubsection{Correlation Does Not Equal Causation}
While noise correlations provide stronger evidence for functional connectivity than cross-correlation alone, they remain fundamentally correlational. Correlated trial-to-trial fluctuations could arise from direct anatomical connections, shared neuromodulatory input, or polysynaptic pathways. Distinguishing these possibilities requires causal perturbation experiments such as optogenetic stimulation/inhibition or focal pharmacological manipulations. Nevertheless, our multi-method approach—combining response latencies, cross-correlations, and noise correlations—provides convergent evidence for specific connectivity patterns.

\subsection{Implications for Visual Processing Models}
Our findings support a revised model of mouse visual cortex organization where parallel processing predominates over strict hierarchical relay. Rather than information flowing sequentially V1 $\rightarrow$ V2 $\rightarrow$ V3, multiple cortical areas receive near-simultaneous thalamic input and engage in rapid bidirectional communication. This architecture may support faster processing of ethologically relevant stimuli (e.g., looming objects, moving predators) where speed is critical for survival.

The functional role of higher-order thalamus (LP) appears modulatory rather than driving, consistent with its position in cortico-thalamo-cortical loops. LP may serve to coordinate cortical dynamics, amplify salient features, or integrate information across visual areas, but does not appear to provide the initial sensory drive for cortical responses to simple visual features.

These organizational principles likely differ across species, stimuli, and behavioral contexts. Primate visual cortex exhibits stronger hierarchical structure with more pronounced serial processing, particularly for object recognition pathways. Even within mouse, different visual features (motion, orientation, spatial frequency) may engage distinct pathways. Future studies examining responses to naturalistic stimuli, during active behavior, or across different cortical layers could reveal context-dependent shifts between parallel and hierarchical processing modes.

\subsection{Conclusions}
Using simultaneous multi-region recordings from the Allen Brain Observatory, we demonstrated that visual information arrives in parallel across mouse visual cortex rather than propagating through strict hierarchical sequences. Response latency analysis revealed simultaneous activation of primary and higher visual areas, while noise correlation analysis confirmed functional connectivity beyond common stimulus drive. The lateral posterior thalamus responds after cortex, suggesting feedback rather than feedforward roles. These findings challenge traditional hierarchical models and support emerging views of visual cortex as a densely interconnected parallel processing network. Our multi-method approach—combining temporal dynamics, cross-correlation, and noise correlation decomposition—provides a generalizable framework for characterizing information flow in large-scale neural recordings.
\bibliography{citation}
\end{document}
